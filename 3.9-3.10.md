## 3.9重力和浮力
### 3.9.1阿基米德定律
重力是一种拉向地球中心的引力，这就如同一个物体周围没有介质包围；没错，就是真空的感觉。重力，在笛卡尔坐标系中方向向下，矢量分量为（0，0，-g），其中$$$g = 9.81m/{s^2}$$$被称作重力加速度。
若一个具有特定质量$$${M\_{obj}}$$$和特定体积$$${V\_{obj}}$$$的物体在一个水柱中释放，此时它不再是仅受全部的重力，而是一个减小的重力，称作浮力，这使它以更小的速率下降或上升，这取决于它周围介质的密度。想象一个充满空气的塑料球，若将它置于水中，它会上浮。
基于阿基米德原理，物体所受的浮力与物体排出水的体积部分的质量与对应体积液体质量之差成比例。参见Stein(1999)对阿基米德的传记。比例的系数为重力加速度。由此，浮力（单位质量物体）可由下式给出：
$$Buoyancy{\kern 1pt} {\kern 1pt} force =  - g{{\left( {{M\_{obj}} - {M\_{amb}}} \right)} \over {{M\_{obj}}}}$$
其中$$${M\_{amb}}$$$是被物体排开的周围（ambient）流体的质量。经过几步化简，上式可由密度来表达，写作：
$$Buoyancy{\kern 1pt} {\kern 1pt} force =  - g{{\left( {{\rho \_{obj}} - {\rho \_{amb}}} \right)} \over {{\rho \_{obj}}}}$$（3.14）
其中$$${r\_{amb}}$$$是周围流体的密度。注意浮力有一个负号，若物体密度大于周围流体密度，则方向向下。那么对于读者来说就不难理解为什么船是用钢铁制作的却能浮在海面上了（除非翻覆了）。
### 3.9.2约化重力
在物理海洋中，浮力（单位质量物体）的减少通常被叫做*约化重力*。这个量使用符号g‘来表示，可以写为：
$$g' = g{{\left( {{\rho \_{obj}} - {\rho \_{amb}}} \right)} \over {{\rho \_{obj}}}}$$(3.15)
应当注意的是，浮力不应当仅仅限制于具有固体外壳的物体。也可能是一个流体微团本身。
### 3.9.3稳定性频率
垂直密度梯度可以表示为*稳定性频率 N*，传统上叫做布朗特瓦萨拉频率Brunt – Va ̈isa ̈la ̈ frequency ，这是为了对Brunt (1927)和Va ̈isa ̈la ̈ (1925)做出的贡献致敬，这一频率被定义为：
$${N^2} =  - {g \over {{\rho \_0}}}{{\partial \rho } \over {\partial z}}$$(3.16)
其中$$${{\rho \_0}}$$$指平均密度。因此，线性密度层结可以表示为：
$$\rho \left( z \right) = {\rho \_0}\left( {1 + {{{N^2}} \over g}\left| z \right|} \right)$$(3.17)
其中$$${{\rho \_0}}$$$指表面密度。

### 3.9.4稳定、中性稳定、不稳定情况
$$${N^2} \> 0$$$的情况对应稳定层结的流体柱。中性稳定层结对应$$${N^2} = 0$$$。当流体柱不稳定层结(密度流体高于轻质流体)时对应$$${N^2} \< 0$$$。这种情况并不能维持较长的时间，因为会触发对流的发生来搅动立体柱。当你从底部加热一锅热水或者汤时，对流伴随着气泡的升起。
## 3.10练习3：浮动物体的震荡
### 3.10.1目标
本练习的目标是使用FORTRAN预测在层结流体柱中浮动微团的轨迹，并用SciLab做结果的可视化。
### 3.10.2任务描述
对接下来的练习，我们假设在100m神的流体柱中密度随深度线性增长。表面的密度是$$$1025kg/{m^3}$$$，稳定性频率的平方为$$${N^2} = {10^{ - 4}}{s^{ - 2}}$$$，这样在底部密度为$$$1026kg/{m^3}$$$。读者的任务是预测一个密度为$$$1025.5kg/{m^3}$$$的物体在80m处释放后的运动轨迹。
### 3.10.3动量方程
为了简化，我们假设运动只发生在垂向。由此，动量方程（3.9）可以简化成一个单一的方程：
$${{d{w\_{obj}}} \over {dt}} =  - g{{\left( {{\rho \_{obj}} - {\rho \_{amb}}} \right)} \over {{\rho \_{obj}}}}$$(3.18)
上一个方程的右边的浮力项发生大小的变化，这决定了物体的位置。在左手边，物体位置$$${z\_{obj}}$$$的变化取决于它的垂向速度$$${w\_{obj}}$$$：
$${{d{z\_{obj}}} \over {dt}} = {w\_{obj}}$$(3.19)
后两个式子互相成对，因为物体的位置决定了周围流体的密度，因此决定了浮力的大小。
### 3.10.4代码结构
代码分三部分：
1.垂向速度$$${w\_{obj}}$$$的预测器
2.新位置$$${z\_{obj}}$$$的预测器
3.基于物体位置的周围海水密度的计算器
### 3.10.5有限差分方程
在有限差分格式中，方程（3.18）可以被写作：
$$w\_{obj}^{n + 1} = w\_{obj}^n + \Delta t \cdot g\left( {{\rho \_{obj}} - {\rho \_{amb}}} \right)/{\rho \_{obj}}$$(3.20)
其中n为时间等级（循环次数），$$$\Delta t$$$为时间步长。方程（3.19）可以被写成：
$$z\_{obj}^{n + 1} = z\_{obj}^n + \Delta t \cdot w\_{obj}^{n + 1}$$(3.21)
在这一方程中，垂向速度$$${w\_{obj}}$$$的（n+1）步的使用意味着将来自前一方程的$$${w\_{obj}}$$$的预测值输入到这个方程中。换句话说，步骤（3.20）在步骤（3.21）之前完成。时间步长我们取$$$\Delta t = 1s$$$。
### 3.10.6初始条件和边界条件
物体的初始位置设置为$$$z\_{obj}^0 =  - 80m$$$。初始的垂向速度$$$w\_{obj}^0$$$为0。边界条件需要特别注意，是为了防止物体陷入海底或者跳出水柱的表面。最简单的解决方案是使边界不可渗透。
### 3.10.7代码范例和动画代码
本练习的FORTRAN 95源代码，保存为“buoyant.f95” ，SciLab 代码名为“buoyant.sce”，被保存在光盘的“Exercise 3”文件夹下。文件“info.txt”包含其他附加信息。
### 3.10.8结果与讨论
图3.9展示了练习3的数值解。期初，物体比周围流体轻，获得一个向上的福利。因此，物体具有向上的加速度，同时它的垂向速度增大知道物体到达平衡位置50m处。这段用时2.5分钟。
当它穿越这一位置后，在它重新减速为0之前，它需要花些时间。直到减速为零时，这个物体会发现自己在20m左右的深度上处于一个低密度环境。它将获得一个反向的浮力，具有向下的加速度。再一次，它穿过平衡位置的密度层。而这次穿越是以*惯性*的形式，这一运动的结果是在平衡位置的密度层附近作垂直震荡。这个震荡的周期略微大于10分钟。[IMG]()
Fig. 3.9 Location of the buoyant object as a function of time. The 50-m depth corresponds to the equilibrium density horizon of the object 
图3.9浮动物体的位置是时间的函数。50m深度对应物体震荡的平衡位置密度层
### 3.10.9解析解
方程（3.18）和（3.19）可以结合成一个带有$$${z\_{obj}}$$$的方程：
$${{d{w\_{obj}}} \over {dt}} = {{{d^2}{z\_{obj}}} \over {d{t^2}}} =  - g{{\left( {{\rho \_{obj}} - {\rho \_{amb}}} \right)} \over {{\rho \_{obj}}}}$$
为了简便，我们定义$$${z^\*}$$$为物体从平衡位置密度层离开的距离。浮力与物体从平衡位置密度层离开的距离成比例，再加上（3.17）式的帮助，我们可以将前式写作：
$${{{d^2}{z^\*}} \over {d{t^2}}} =  - {N^2}{z^\*}$$(3.23)
由此，我们寻找一个函数，它的二阶时间导数能够给出一个相同的方程乘以一个系数$$${N^2}$$$和负号。只有一种形式的函数满足如上要求，那就是余弦函数，它的解析解是：
$${z^\*}\left( t \right) = z\_0^\*\cos \left( {Nt} \right)$$(3.24)
其中$$$z\_0^\*$$$是物体从平衡位置密度层离开距离的初始值。这个波动的周期与稳定性频率的关系是T=2π/N。我们得出练习3的周期T=628.3s=10.47mins。预测的结果应当接近这一解析解。我鼓励读者选取其他稳定性频率N、物体密度或初始释放位置来测试（3.24）式。垂直速度可以写作：
$${w\_{obj}} = {{d{z^\*}} \over {dt}} = z\_0^\*N\sin \left( {Nt} \right) = {w\_0}\sin \left( {Nt} \right)$$
其中$$${w\_0} = z\_0^\*N$$$是物体穿越平衡位置时的、它所具有的最大速度。在我们的例子中$$$z\_0^\* = 30m$$$, $$$N = 0.01{s^{ - 1}}$$$，给出的最大速度在30cm/s左右。
### 3.10.10考虑摩擦
基于物体所受摩擦力比例于它的速度的假设下，方程（3.18）可以扩展为：
$${{d{w\_{obj}}} \over {dt}} =  - g{{\left( {{\rho \_{obj}} - {\rho \_{amb}}} \right)} \over {{\rho \_{obj}}}} - R{w\_{obj}}$$(3.25)
其中摩擦系数R具有单位1/s。使用隐式格式，该方程的有限差分形式可写为：
$${{w\_{obj}^{n + 1} - w\_{obj}^n} \over {\Delta t}} =  - g{{{\rho \_{obj}} - {\rho \_{amb}}} \over {{\rho \_{obj}}}} - Rw\_{obj}^{n + 1}$$(3.26)
用来生成垂直速度可以改写成：
$$w\_{obj}^{n + 1} = \left[ {w\_{obj}^n - \Delta t \cdot g\left( {{\rho \_{obj}} - {\rho \_{amb}}} \right)/{\rho \_{obj}}} \right]/\left( {1 + R\Delta t} \right)$$
图3.10展示了$$${R = 0.002{s^{ - 1}}}$$$的结果，可称作*阻尼震荡*。在FORTRAN代码中只有一部分需要改变就能实现这个。首先摩擦系数常量需要在声明部分加入：
> REAL :: R ! friction parameter
  
第二，常量需要赋值
> R = 0.002 ! value of friction parameter
  
最后，在动量方程中添加摩擦力项。
> WOBJN=(WOBJ+dt*BF)/(1.+R*dt) ! predict new vertical speed 

[IMG]()
Fig. 3.10 Same as Fig. 3.9, but with inclusion of friction 
图3.10和图3.9相似，但包含了摩擦力
### 3.10.11对读者的附加练习
重复这一练习并包含摩擦力项，同时在$$$0.001{s^{ - 1}}$$$到$$$0.5{s^{ - 1}}$$$之间改变摩擦系数。高级的读者可以尝试使用$$$ - R\left| W \right|W$$$这种形式的二次摩擦项，其中R此时的单位是1/m。使用一个半隐半显式的方法来尝试，即$$$ - R\left| {{W^n}} \right|{W^{n + 1}}$$$，同时R选择不同的值。使用FORTRAN中的函数“ABS()”来计算绝对值$$$\left| {{W^n}} \right|$$$。









