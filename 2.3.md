## 2.3练习1:衰减问题
---- 
### 2.3.1目的
这个练习的目的是根据（2.1）式基于显式或隐式格式使用FORTRAN代码来预测物质的衰减。
### 2.3.2任务描述
考虑一种初始浓度为100%的物质，使用衰减率为κ=0.0001/s(或κ=10-4s-1)。选用不同的时间步长来检验预测结果是否因精细化的时间分辨率而变的更精准。同时测试显式和隐式格式。
### 2.3.3说明
使用任意文字编辑器来写FORTRAN代码，将文件保存为“Excercise1.f95”。空格和其他不常用字符不能在这里（文件名中）使用。其他文件名也许可以使用，但读者应当确保文件名不能太长，该练习可能还有其他用途。文件的扩展名“f95”代表这软件是FORTRAN95的源代码。
### 2.3.4代码范例
该练习的FORTRAN代码，名为“winethief.f95”，被保存在本书CD-ROM光盘的“Excercise1”文件夹下。
### 2.3.5结果
作为该模型的运行结果，数据输出文件“output1.txt”或“output2.txt”应当出现在文件列表中。代码中的MODE参数用于在显式和隐式格式间切换。为避免再编译步骤，“mode”的值（由读者）使用代码`READ(5,*) mode`.通过键盘输入。
图2.2展示了使用时间步长为Δt = 3600 s、显式格式（2.3）和隐式格式（2.6）的模型结果。从中可以看出，显式格式轻微低估了正确的结果，而隐式格式轻微高估了正确的结果。一种半隐半显式的格式也许能给出最好的结果，但这有待于读者考证。
使用3600s的时间步长，在我的电脑上，模型运行仅仅花了几秒钟时间。若选择更精细的时间分辨率，如步长使用Δt = 1s，预测结果的精度将得到大幅提升，读者可以轻松验证。
### 2.3.6拓展练习
使用混合格式（2.7）重复这一练习，探索α = 0.25, 0.5, 0.75的结果。
![]()
Fig. 2.2 Evolution of concentration (%) as a function of time. The upper and lower curves show results using the implicit and the explicit schemes, respectively. The middle curve displays the analytical solution according to Eq. 2.8
图2.2 浓度的演变是时间的函数。上下两条虚线分别为使用了隐式格式和显示格式的结果。中间的曲线为根据（2.8）式得到的解析解。

